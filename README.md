# RBvoice - AI Interview Platform

A React-based AI interview platform with proper routing and page management.

## Features

- **Multi-page routing** with React Router
- **Protected routes** requiring authentication
- **Interview workflow** with multiple stages
- **Transcript editing** capabilities
- **Responsive design** with Tailwind CSS

## Routes Structure

### Public Routes
- `/login` - User authentication page

### Protected Routes (require login)
- `/` - Landing page after login
- `/interview/idle` - Interview preparation page
- `/interview/preparing` - Interview setup page
- `/interview/active` - Active interview session
- `/interview/completed` - Interview results and transcript

## Getting Started

1. Install dependencies:
   ```bash
   npm install
   ```

2. Start the development server:
   ```bash
   npm run dev
   ```

3. Open your browser and navigate to `http://localhost:5173`

## Usage

1. **Login**: Enter any email and password to access the platform
2. **Start Interview**: Click "Start Interview" on the landing page
3. **Prepare**: Review the checklist and click "Begin Interview Now"
4. **Interview**: Answer questions using the voice interface
5. **Review**: View and edit your interview transcript
6. **Complete**: Save your results or start a new interview

## Technology Stack

- **React 18** with TypeScript
- **React Router DOM** for routing
- **Tailwind CSS** for styling
- **Lucide React** for icons
- **Vite** for build tooling

## Project Structure

```
src/
├── components/
│   ├── Layout.tsx          # Main layout with sidebar
│   ├── LandingPage.tsx     # Welcome page
│   ├── IdlePage.tsx        # Interview preparation
│   ├── PreparingPage.tsx   # Setup page
│   ├── InterviewPage.tsx   # Active interview
│   └── CompletedPage.tsx   # Results page
├── App.tsx                 # Main app with routing
├── Login.tsx              # Authentication
└── main.tsx               # Entry point
```

## Development

- **Build**: `npm run build`
- **Preview**: `npm run preview`
- **Lint**: `npm run lint`

## Notes

- This is a demo application with mock data
- Voice recording functionality is simulated
- Authentication is client-side only for demonstration
- In production, implement proper backend integration

## Backend (FastAPI + Supabase)

A lightweight backend is included under `backend/` and is configured to use Supabase (Postgres-as-a-service) instead of a local Postgres instance.

Endpoints (GET and POST):
- `/response` — interview completed, tab switch count, start/end times, is_terminated
- `/annotate` — updates, edit count, last edited
- `/feedback` — generic feedback submission

### Quickstart (Supabase)

1. Create a virtualenv and install deps:
   ```bash
   python3 -m venv .venv && source .venv/bin/activate
   pip install -r backend/requirements.txt
   ```
2. Set env vars (create a file named `.env` inside `backend/`):
   ```bash
   SUPABASE_URL=your_supabase_url
   SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
   ```
3. Run the server:
   ```bash
   uvicorn backend.main:app --reload
   ```
4. Swagger docs: `http://localhost:8000/docs`

### Tables (Supabase)

The backend expects the following tables in your Supabase project. You can create them via SQL (Database -> SQL Editor):

```sql
-- interview_responses
create table if not exists interview_responses (
  response_id bigint generated by default as identity primary key,
  candidate_id bigint not null,
  interviewer_id bigint,
  tab_switch_count int default 0,
  start_time timestamptz,
  end_time timestamptz,
  is_terminated boolean default false,
  is_completed boolean default false,
  response jsonb,
  audio_url text,
  transcription_url text,
  annotated_response jsonb,
  edit_count int,
  last_edited_at timestamptz,
  created_at timestamptz default now()
);

-- candidate_interview_feedback
create table if not exists candidate_interview_feedback (
  feedback_id bigint generated by default as identity primary key,
  response_id bigint not null references interview_responses(response_id) on delete cascade,
  feedback text,
  satisfaction int,
  created_at timestamptz default now()
);

-- agentic_interviewer (stores interviewer config/questions)
create table if not exists agentic_interviewer (
  interviewer_id bigint primary key,
  questions jsonb default '[]'::jsonb,
  question_count int default 0
);
```

Note: Replace types/constraints as needed for your usage.

### Why Supabase instead of local Postgres?
- Managed Postgres with built-in auth, storage, and REST capabilities
- No need to run or expose a local database
- Easy to deploy and scale

### Environment variables
The backend now requires environment variables and no longer uses hardcoded defaults. If you see "Missing SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY", ensure your `backend/.env` is present with valid values.
